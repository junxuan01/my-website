---
title: "Rust 语言基础之数组与元组"
description: "深入了解 Rust 的两个原生复合类型：元组和数组的定义与使用。"
date: "2025-11-30"
seriesOrder: 11
---

# 11. Rust 语言基础之数组与元组

## 引言

在 JavaScript 中，数组（Array）是一个万能容器：它可以变长，可以包含不同类型的元素（`[1, "hello", true]`）。

在 Rust 中，为了保证内存安全和性能，这种"万能"的特性被拆分成了两个不同的概念：
1.  **元组 (Tuple)**：长度固定，可以包含**不同类型**的元素。
2.  **数组 (Array)**：长度固定，必须包含**相同类型**的元素。

如果你需要一个既能变长又能包含相同类型元素的容器，那你需要的是 **向量 (Vector)**，我们将在下一篇介绍。

本篇文章将带你深入了解 Rust 的两个原生复合类型：元组和数组。

## 1. 元组 (Tuple)

元组是将多个值组合成一个复合值的最简单方式。

### 1.1 定义与类型签名

元组的长度是固定的：一旦声明，就不能增长或缩小。

```rust
// 语法：(类型1, 类型2, ...)
let tup: (i32, f64, u8) = (500, 6.4, 1);
```

### 1.2 访问元素

有两种方式访问元组中的元素：

**方式一：使用点号 (.) 加索引**

```rust
let x: (i32, f64, u8) = (500, 6.4, 1);

let five_hundred = x.0;
let six_point_four = x.1;
let one = x.2;
```

**方式二：解构 (Destructuring)**

这与 JS 的解构赋值非常相似。

```rust
let tup = (500, 6.4, 1);
let (x, y, z) = tup;

println!("The value of y is: {}", y);
```

### 1.3 单元类型 (Unit Type)

没有任何值的元组 `()` 有一个特殊的名字，叫做**单元类型 (Unit Type)**，其值被称为**单元值 (Unit Value)**。

如果一个表达式不返回任何有意义的值（例如 `println!` 或赋值语句），它默认返回 `()`。这类似于 JS 中的 `undefined`（作为返回值时）。

## 2. 数组 (Array)

Rust 的数组与 JS 的数组有本质区别。

### 2.1 定义与特点

*   **相同类型**：所有元素必须是同一类型。
*   **固定长度**：一旦定义，长度不能改变。
*   **栈上分配**：数据直接存储在栈（Stack）上，而不是堆（Heap）上。

```rust
// 语法：[类型; 长度]
let a: [i32; 5] = [1, 2, 3, 4, 5];
```

### 2.2 初始化技巧

如果你想创建一个包含 5 个元素，且每个元素都是 3 的数组：

```rust
let a = [3; 5]; 
// 等同于 let a = [3, 3, 3, 3, 3];
```

### 2.3 访问元素

使用方括号 `[]` 访问。

```rust
let a = [1, 2, 3, 4, 5];
let first = a[0];
let second = a[1];
```

### 2.4 越界访问 (Out of Bounds)

这是 Rust 安全性的一个体现。

```rust
let a = [1, 2, 3, 4, 5];
let index = 10;
let element = a[index]; // 运行时 Panic！
```

如果你尝试访问超出数组长度的索引：
*   如果索引是编译时常量，Rust 编译器会直接报错，拒绝编译。
*   如果索引是运行时确定的，程序会在运行时 **Panic**（崩溃并退出），而不是像 C 语言那样访问非法内存（导致安全漏洞），也不像 JS 那样返回 `undefined`。

### 2.5 数组切片 (Slicing)

虽然数组长度固定，但我们可以创建数组的**切片 (Slice)**。切片是对数组一部分的引用。

```rust
let a = [1, 2, 3, 4, 5];
let slice = &a[1..3]; // 包含 a[1] 和 a[2]，类型是 &[i32]
assert_eq!(slice, &[2, 3]);
```

## 3. 什么时候用数组，什么时候用元组？

*   **元组**：当你需要组合**不同类型**的数据，且不需要动态增删时。例如，函数返回多个值（坐标 x, y）。
*   **数组**：当你需要组合**相同类型**的数据，且**元素数量固定**时。例如，表示一周的 7 天，或者一个固定大小的缓冲区。
*   **向量 (Vec)**：当你需要组合**相同类型**的数据，且**数量不确定**（需要动态增删）时。这是最常用的集合类型。

## 4. 总结

| 特性 | 元组 (Tuple) | 数组 (Array) | 向量 (Vec, 下篇讲) | JS 数组 |
| :--- | :--- | :--- | :--- | :--- |
| **长度** | 固定 | 固定 | **可变** | 可变 |
| **元素类型** | **可不同** | 必须相同 | 必须相同 | 可不同 |
| **存储位置** | 栈 | 栈 | 堆 | 堆 |
| **语法** | `(1, "a")` | `[1, 2]` | `vec![1, 2]` | `[1, "a"]` |

Rust 将 JS 数组的功能拆分成了 Array 和 Vec，是为了在不同场景下提供最优的性能和安全性。

下一篇，我们将介绍 Rust 中最重要、最常用的集合类型——**向量 (Vector)**，以及切片 (Slice) 的详细用法。

---

