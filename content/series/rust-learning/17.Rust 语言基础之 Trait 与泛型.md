---
title: "Rust è¯­è¨€åŸºç¡€ä¹‹ Trait ä¸æ³›å‹"
description: "å­¦ä¹ æ³›å‹å’Œ Trait çš„ä½¿ç”¨ï¼Œç¼–å†™å¯å¤ç”¨ã€ç®€æ´ä¸”é«˜æ•ˆçš„ Rust ä»£ç ã€‚"
date: "2025-11-30"
seriesOrder: 17
---

# 17. Rust è¯­è¨€åŸºç¡€ä¹‹ Trait ä¸æ³›å‹

## å¼•è¨€

è¿™æ˜¯æˆ‘ä»¬ Rust åŸºç¡€ç³»åˆ—çš„æœ€åä¸€ç¯‡ã€‚

ä¸ºäº†ç¼–å†™å¯å¤ç”¨ã€ç®€æ´ä¸”é«˜æ•ˆçš„ä»£ç ï¼Œæˆ‘ä»¬éœ€è¦ä¸¤ä¸ªå¼ºå¤§çš„å·¥å…·ï¼š
1.  **æ³›å‹ (Generics)**ï¼šç”¨äºå¤„ç†å¤šç§æ•°æ®ç±»å‹ï¼Œå‡å°‘ä»£ç é‡å¤ã€‚
2.  **Trait (ç‰¹å¾)**ï¼šå®šä¹‰å…±äº«çš„è¡Œä¸ºï¼ˆç±»ä¼¼æ¥å£ï¼‰ï¼Œå®ç°å¤šæ€ã€‚

## 1. æ³›å‹ (Generics)

æ³›å‹å…è®¸æˆ‘ä»¬å®šä¹‰å‡½æ•°æˆ–ç»“æ„ä½“æ—¶ä½¿ç”¨å ä½ç¬¦ç±»å‹ï¼Œè€Œä¸æ˜¯å…·ä½“ç±»å‹ã€‚

### 1.1 åœ¨å‡½æ•°ä¸­ä½¿ç”¨æ³›å‹

å‡è®¾æˆ‘ä»¬è¦å†™ä¸€ä¸ªå‡½æ•°ï¼Œæ‰¾å‡ºåˆ‡ç‰‡ä¸­çš„æœ€å¤§å€¼ã€‚å¦‚æœä¸ä½¿ç”¨æ³›å‹ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦ä¸º `i32` å†™ä¸€ä¸ªï¼Œä¸º `f64` å†™ä¸€ä¸ªã€‚

ä½¿ç”¨æ³›å‹ï¼š

```rust
fn largest<T: PartialOrd + Copy>(list: &[T]) -> T {
    let mut largest = list[0];

    for &item in list {
        if item > largest {
            largest = item;
        }
    }

    largest
}
```

*   `<T>`ï¼šå£°æ˜æ³›å‹å‚æ•° Tã€‚
*   `list: &[T]`ï¼šå‚æ•°æ˜¯ T ç±»å‹çš„åˆ‡ç‰‡ã€‚
*   `-> T`ï¼šè¿”å›å€¼æ˜¯ T ç±»å‹ã€‚
*   `PartialOrd + Copy`ï¼šè¿™æ˜¯ **Trait Bound**ï¼ˆåé¢ä¼šè®²ï¼‰ï¼Œé™åˆ¶ T å¿…é¡»èƒ½æ¯”è¾ƒå¤§å°ä¸”èƒ½è¢«å¤åˆ¶ã€‚

### 1.2 åœ¨ç»“æ„ä½“ä¸­ä½¿ç”¨æ³›å‹

```rust
struct Point<T> {
    x: T,
    y: T,
}

fn main() {
    let integer = Point { x: 5, y: 10 };
    let float = Point { x: 1.0, y: 4.0 };
    // let wont_work = Point { x: 5, y: 4.0 }; // âŒ é”™è¯¯ï¼x å’Œ y å¿…é¡»æ˜¯åŒä¸€ç§ç±»å‹
}
```

å¦‚æœæƒ³è®© x å’Œ y ç±»å‹ä¸åŒï¼Œå¯ä»¥ä½¿ç”¨å¤šä¸ªæ³›å‹å‚æ•°ï¼š

```rust
struct Point<T, U> {
    x: T,
    y: U,
}
```

## 2. Trait (ç‰¹å¾)

Trait å‘Šè¯‰ Rust ç¼–è¯‘å™¨æŸç§ç±»å‹å…·æœ‰å“ªäº›åŠŸèƒ½ï¼Œå¹¶ä¸”å¯ä»¥ä¸å…¶ä»–ç±»å‹å…±äº«è¿™äº›åŠŸèƒ½ã€‚å®ƒç±»ä¼¼äº Java çš„ Interface æˆ– Haskell çš„ Typeclassã€‚

### 2.1 å®šä¹‰ Trait

```rust
pub trait Summary {
    fn summarize(&self) -> String;
}
```

### 2.2 å®ç° Trait

å‡è®¾æˆ‘ä»¬æœ‰ `NewsArticle` å’Œ `Tweet` ä¸¤ä¸ªç»“æ„ä½“ï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒä»¬éƒ½èƒ½è¢«"æ€»ç»“"ã€‚

```rust
pub struct Tweet {
    pub username: String,
    pub content: String,
    pub reply: bool,
    pub retweet: bool,
}

impl Summary for Tweet {
    fn summarize(&self) -> String {
        format!("{}: {}", self.username, self.content)
    }
}
```

### 2.3 é»˜è®¤å®ç°

Trait å¯ä»¥æä¾›é»˜è®¤çš„æ–¹æ³•å®ç°ã€‚

```rust
pub trait Summary {
    fn summarize(&self) -> String {
        String::from("(Read more...)")
    }
}
```

å¦‚æœç±»å‹å®ç°äº†è¯¥ Trait ä½†æ²¡æœ‰é‡å†™è¯¥æ–¹æ³•ï¼Œå°±ä¼šä½¿ç”¨é»˜è®¤å®ç°ã€‚

## 3. Trait ä½œä¸ºå‚æ•°

æˆ‘ä»¬å¯ä»¥ç¼–å†™æ¥å—ä»»ä½•å®ç°äº†ç‰¹å®š Trait çš„ç±»å‹çš„å‡½æ•°ã€‚

### 3.1 `impl Trait` è¯­æ³• (è¯­æ³•ç³–)

```rust
pub fn notify(item: &impl Summary) {
    println!("Breaking news! {}", item.summarize());
}
```

è¿™è¡¨ç¤º `item` å¯ä»¥æ˜¯ä»»ä½•å®ç°äº† `Summary` trait çš„ç±»å‹ã€‚

### 3.2 Trait Bound (ç‰¹å¾çº¦æŸ)

`impl Trait` å®é™…ä¸Šæ˜¯ Trait Bound çš„è¯­æ³•ç³–ã€‚å®Œæ•´å†™æ³•å¦‚ä¸‹ï¼š

```rust
pub fn notify<T: Summary>(item: &T) {
    println!("Breaking news! {}", item.summarize());
}
```

### 3.3 æŒ‡å®šå¤šä¸ªçº¦æŸ (`+`)

å¦‚æœæˆ‘ä»¬éœ€è¦å‚æ•°æ—¢å®ç° `Summary` åˆå®ç° `Display`ï¼š

```rust
pub fn notify(item: &(impl Summary + Display)) { ... }
```

æˆ–è€…ï¼š

```rust
pub fn notify<T: Summary + Display>(item: &T) { ... }
```

### 3.4 `where` å­å¥

å½“çº¦æŸå¤ªé•¿æ—¶ï¼Œå‡½æ•°ç­¾åä¼šå˜å¾—å¾ˆéš¾çœ‹ã€‚å¯ä»¥ä½¿ç”¨ `where` å­å¥ä¼˜åŒ–ï¼š

```rust
fn some_function<T, U>(t: &T, u: &U) -> i32
    where T: Display + Clone,
          U: Clone + Debug
{
    ...
}
```

## 4. JS / Go / Rust å¯¹æ¯”

| ç‰¹æ€§ | JavaScript/TypeScript | Go | Rust |
| :--- | :--- | :--- | :--- |
| **æ³›å‹** | TS: `function<T>(x: T)` | Go 1.18+: `func[T any](x T)` | `fn<T>(x: T)` |
| **æ¥å£/ç‰¹å¾** | TS: `interface` | `interface` | `trait` |
| **å®ç°æ–¹å¼** | éšå¼ (Duck Typing) | éšå¼å®ç° | æ˜¾å¼ `impl Trait for Type` |
| **çº¦æŸè¯­æ³•** | TS: `<T extends X>` | `[T Constraint]` | `<T: Trait>` æˆ– `where` |

**Go Interface vs Rust Trait**ï¼š

```go
// Go: éšå¼å®ç°ï¼Œåªè¦æ–¹æ³•ç­¾ååŒ¹é…å°±è‡ªåŠ¨å®ç°
type Stringer interface {
    String() string
}

type Person struct { Name string }

func (p Person) String() string { return p.Name }
// Person è‡ªåŠ¨å®ç°äº† Stringerï¼Œæ— éœ€æ˜¾å¼å£°æ˜
```

```rust
// Rust: æ˜¾å¼å®ç°ï¼Œå¿…é¡»ç”¨ impl for å£°æ˜
trait Display {
    fn display(&self) -> String;
}

struct Person { name: String }

impl Display for Person {
    fn display(&self) -> String { self.name.clone() }
}
```

**å…³é”®åŒºåˆ«**ï¼š
- Go æ˜¯éšå¼å®ç°ï¼ˆDuck Typingï¼‰ï¼ŒRust æ˜¯æ˜¾å¼å®ç°
- Rust çš„ Trait å¯ä»¥æœ‰é»˜è®¤å®ç°ï¼ŒGo çš„ Interface ä¸è¡Œ
- Rust å¯ä»¥ä¸ºå¤–éƒ¨ç±»å‹å®ç°è‡ªå·±çš„ Traitï¼ˆå­¤å„¿è§„åˆ™é™åˆ¶ä¸‹ï¼‰

## 5. æ€»ç»“ä¸ç»“è¯­

æ­å–œä½ ï¼ä½ å·²ç»å®Œæˆäº† Rust åŸºç¡€ç³»åˆ—çš„å­¦ä¹ ã€‚

åœ¨è¿™ 17 ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä» Rust çš„å†å²èƒŒæ™¯å‡ºå‘ï¼Œä¸€è·¯å­¦ä¹ äº†ï¼š
*   **åŸºç¡€è¯­æ³•**ï¼šå˜é‡ã€æ•°æ®ç±»å‹ã€æµç¨‹æ§åˆ¶ã€‚
*   **æ ¸å¿ƒæ¦‚å¿µ**ï¼šæ‰€æœ‰æƒã€å€Ÿç”¨ã€ç”Ÿå‘½å‘¨æœŸï¼ˆè™½ç„¶æ²¡æ·±å…¥å±•å¼€ï¼Œä½†å€Ÿç”¨è§„åˆ™å·²æ¶‰åŠï¼‰ã€‚
*   **æ•°æ®ç»“æ„**ï¼šæ•°ç»„ã€åˆ‡ç‰‡ã€Vectorã€HashMapã€Structã€Enumã€‚
*   **æŠ½è±¡èƒ½åŠ›**ï¼šæ³›å‹ã€Traitã€‚

**æ¥ä¸‹æ¥çš„è·¯æ€ä¹ˆèµ°ï¼Ÿ**

1.  **å¤šå†™ä»£ç **ï¼šRust æ˜¯ä¸€é—¨"å®è·µå‡ºçœŸçŸ¥"çš„è¯­è¨€ã€‚å°è¯•ç”¨ Rust é‡å†™ä¸€äº›å°å·¥å…·ã€‚
2.  **é˜…è¯»ã€ŠThe Rust Programming Languageã€‹**ï¼šå®˜æ–¹ä¹¦æ˜¯æœ€å¥½çš„æ•™æï¼Œæ¶µç›–äº†æ›´å¤šç»†èŠ‚ï¼ˆå¦‚ç”Ÿå‘½å‘¨æœŸã€æ™ºèƒ½æŒ‡é’ˆã€å¹¶å‘ã€å®ï¼‰ã€‚
3.  **ç»ƒä¹  Rustlings**ï¼šå®˜æ–¹æä¾›çš„äº¤äº’å¼ç»ƒä¹ é¢˜ã€‚
4.  **å…³æ³¨ç¤¾åŒº**ï¼šRust ç¤¾åŒºéå¸¸æ´»è·ƒä¸”å‹å¥½ã€‚

æ„¿ä½ åœ¨ Rust çš„ä¸–ç•Œé‡Œæ¢ç´¢æ„‰å¿«ï¼Happy Rusting! ğŸ¦€

---

**ç³»åˆ—ç›®å½•**ï¼š[è¿”å›æ ¹ç›®å½•](../README.md)
