---
title: "Rust 语言安装与环境配置"
description: "在 macOS、Windows 和 Linux 上安装 Rust，配置国内镜像加速，并设置 VS Code 开发环境。"
date: "2025-11-30"
seriesOrder: 5
---

# 5. Rust 语言安装与环境配置

## 引言

工欲善其事，必先利其器。在开始编写 Rust 代码之前，我们需要搭建一个舒适的开发环境。

对于前端开发者来说，安装 Rust 的体验非常类似于安装 Node.js。Rust 有一个官方的版本管理器 `rustup`（类似于 `nvm`），以及一个包管理器 `cargo`（类似于 `npm`）。

本篇文章将指导你在 macOS、Windows 和 Linux 上安装 Rust，配置国内镜像加速，并设置 VS Code 开发环境。

## 1. 安装 Rust

### 1.1 使用 rustup 安装 (推荐)

`rustup` 是 Rust 官方的工具链安装器和版本管理工具。

#### macOS 和 Linux

打开终端，运行以下命令：

```bash
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
```

安装过程中会提示你选择安装选项，通常直接按 **回车** 选择默认项（Default）即可。

安装完成后，你需要刷新环境变量（或者重启终端）：

```bash
source "$HOME/.cargo/env"
```

#### Windows

1.  访问 [rustup.rs](https://rustup.rs/)。
2.  下载 `rustup-init.exe`。
3.  运行安装程序，按照提示操作。
    *   **注意**：Rust 依赖 C++ 构建工具。如果你的电脑上没有安装 Visual Studio C++ 生成工具，安装程序会提示你安装。请务必安装它（勾选 "Desktop development with C++"）。

### 1.2 验证安装

安装完成后，在终端输入以下命令检查版本：

```bash
rustc --version
cargo --version
```

如果能看到类似 `rustc 1.91.0 (...)` 的输出，说明安装成功了！

## 2. 配置国内镜像加速

由于 Rust 的官方源在国外，国内下载依赖可能会非常慢。强烈建议配置国内镜像。

### 2.1 配置 rustup 镜像 (加速工具链更新)

在你的 shell 配置文件（如 `~/.zshrc` 或 `~/.bashrc`）中添加以下环境变量：

```bash
# 使用中科大镜像
export RUSTUP_DIST_SERVER=https://mirrors.ustc.edu.cn/rust-static
export RUSTUP_UPDATE_ROOT=https://mirrors.ustc.edu.cn/rust-static/rustup
```

### 2.2 配置 Cargo 镜像 (加速依赖下载)

Cargo 的配置文件位于 `~/.cargo/config.toml`（Windows 下是 `%USERPROFILE%\.cargo\config.toml`）。如果文件不存在，请手动创建。

在文件中添加以下内容（以使用中科大源为例）：

```toml
[source.crates-io]
replace-with = 'ustc'

[source.ustc]
registry = "sparse+https://mirrors.ustc.edu.cn/crates.io-index/"
```

**注意**：`sparse+` 协议是 Rust 1.68+ 引入的新特性，能极大提升索引下载速度。

## 3. 开发工具配置 (VS Code)

Visual Studio Code 是目前写 Rust 最好的编辑器之一（另一个选择是 JetBrains 的 RustRover）。

### 3.1 安装插件

在 VS Code 扩展商店中搜索并安装以下插件：

1.  **rust-analyzer** (必装)：这是官方推荐的 Rust 语言服务器。它提供了极其强大的代码补全、类型推断显示、跳转定义和重构功能。
    *   *注意：不要安装那个旧的 "Rust" 插件，它已经过时了。*
2.  **CodeLLDB** (推荐)：用于调试 Rust 程序。
3.  **Even Better TOML** (推荐)：用于高亮和格式化 `Cargo.toml` 文件。
4.  **crates** (推荐)：在 `Cargo.toml` 中显示依赖的最新版本号，方便升级。

### 3.2 配置 rust-analyzer

安装好 `rust-analyzer` 后，打开一个 Rust 文件，你可能会发现代码上方出现了一些灰色的文字（Inlay Hints），显示了变量的推断类型。

如果你觉得这些提示太干扰，可以在 VS Code 设置中搜索 `inlayHints` 进行调整，或者在 `settings.json` 中添加：

```json
"editor.inlayHints.enabled": "offUnlessPressed" // 按住 Ctrl/Option 才显示
```

## 4. Hello, World!

环境配好了，让我们来写第一个 Rust 程序。

### 4.1 创建项目

虽然你可以直接用 `rustc main.rs` 编译单个文件，但在实际开发中，我们几乎总是使用 `cargo` 来创建和管理项目。

打开终端，运行：

```bash
cargo new hello_rust
cd hello_rust
```

这会创建一个名为 `hello_rust` 的目录，结构如下：

```
hello_rust/
├── Cargo.toml    # 项目配置文件 (类似 package.json)
└── src/
    └── main.rs   # 源代码
```

### 4.2 查看代码

打开 `src/main.rs`，你会看到：

```rust
fn main() {
    println!("Hello, world!");
}
```

*   `fn`：定义函数的关键字（Function）。
*   `main`：程序的入口函数。
*   `println!`：这是一个**宏**（Macro），而不是函数（注意后面的 `!`）。宏是 Rust 的高级特性，现在你只需要知道它用于打印输出即可。

### 4.3 运行项目

在项目根目录下运行：

```bash
cargo run
```

你会看到输出：

```
   Compiling hello_rust v0.1.0 (/path/to/hello_rust)
    Finished dev [unoptimized + debuginfo] target(s) in 0.52s
     Running `target/debug/hello_rust`
Hello, world!
```

`cargo run` 实际上做了两件事：
1.  编译源代码（生成可执行文件）。
2.  运行生成的可执行文件。

如果你只想编译不运行，可以使用 `cargo build`。

## 5. 总结

恭喜！你已经成功搭建了 Rust 开发环境，并运行了第一个程序。

*   **rustup**：管理 Rust 版本。
*   **cargo**：管理项目依赖和构建。
*   **rust-analyzer**：VS Code 里的智能助手。

在下一篇文章中，我们将深入了解 `Cargo` 的更多用法，以及如何像 npm 一样管理项目依赖。

---

**上一篇**：[4.学习 Rust 语言的资源和建议](./4.学习%20Rust%20语言的资源和建议.md)
**下一篇预告**：[6.Rust 语言依赖管理以及 Cargo 使用](./6.Rust%20语言依赖管理以及%20Cargo%20使用.md)
